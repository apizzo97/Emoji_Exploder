<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Emoji Exploder</title>
    <style>*{padding: 5px; margins: 5px;}</style>
    <script src="phaser.min.js"></script>
</head>
<body>
    <script>
        var game = new Phaser.Game(1400, 700, Phaser.AUTO, "",
            {preload: preload, create: create, update: update});

        function preload(){
            console.log(game);
            //make responsive
            game.scale.pageAlignHorizontally = true;
            game.scale.pageAlignVertically = true;
            game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;

            //load background
            game.stage.backgroundColor = ("#FFFFFF");
            game.load.image("background", "assets/background.png" );

            //load cannon and cannon wheel
            game.load.image("cannon_wheel", "assets/cannon-wheel.png");
            game.load.image("cannon", "assets/cannon.png");

            //load emojis
            game.load.image("cat", "assets/cat-emoji.png");
            game.load.image("heart", "assets/heart-emoji.png");
            game.load.image("poop", "assets/poop-emoji.png");
            game.load.image("screaming", "assets/screaming-emoji.png");
            game.load.image("tears", "assets/tears-emoji.png");
            game.load.image("tongue", "assets/tongue-emoji.png");
            game.load.image("upsideDown", "assets/upsidedown-emoji.png");

            //load arrows
            game.load.image("arrowRight", "assets/triangle-right.png");
            game.load.image("arrowLeft", "assets/triangle-left.png");


        }

        var background;
        var cannon_wheel;
        var cannon;
        var cat;
        var heart;
        var poop;
        var scream;
        var tears;
        var tongue;
        var upsideDown;
        var score = 0;
        var textStyle;
        var timerEvent;
        var timer;
        var endGame;
        var endButton;
        var minutes;
        var seconds






        function create() {
            console.log(game);
            //background
            background = game.add.tileSprite(0, 0, 1400, 700, "background");

            //cannon wheel
            cannon_wheel = game.add.sprite(40, 600, "cannon_wheel");
            cannon_wheel.moveUp(cannon_wheel);

            //cannon
            cannon = game.add.sprite(25, 550, "cannon");

            //emojis
            cat = game.add.sprite(700, 750, "cat");
            heart = game.add.sprite(700, 750, "heart");
            poop = game.add.sprite(700, 750, "poop");
            scream = game.add.sprite(700, 750, "screaming");
            tears = game.add.sprite(700, 750, "tears");
            tongue = game.add.sprite(700, 750, "tongue");
            upsideDown = game.add.sprite(700, 750, "upsideDown");

            //add physics
            game.physics.startSystem(Phaser.Physics.ARCADE);
            game.physics.enable(cannon, Phaser.Physics.ARCADE);
            game.physics.enable(cat, Phaser.Physics.ARCADE);
            game.physics.enable(heart, Phaser.Physics.ARCADE);
            game.physics.enable(poop, Phaser.Physics.ARCADE);
            game.physics.enable(scream, Phaser.Physics.ARCADE);
            game.physics.enable(tears, Phaser.Physics.ARCADE);
            game.physics.enable(tongue, Phaser.Physics.ARCADE);
            game.physics.enable(upsideDown, Phaser.Physics.ARCADE);

            //create timer
            timer = game.time.create();
            timerEvent = timer.add(Phaser.Timer.MINUTE + Phaser.Timer.SECOND * 30, this.endTimer, this);
            timer.start();

        }

        function endTimer() {
            timer.stop();
        }

        function formatTime(s) {
            timer = game.add.text(700, 400, "3:00", {font: "100px Arial", fill: "#fff"});
            minutes = "0" + Math.floor(s/60);
            seconds = "0" + (s - minutes * 60);
            return minutes.substr(-2) + ":" + seconds.substr(-2);
        }


        function update(){
            if (timer.running) {
                game.add.text(formatTime(Math.round((timerEvent.delay - timer.ms)/1000)), 700, 200, "#fff");
                game.physics.arcade.accelerateToXY(cat, -100, 700, 100, 100, 100);
                game.physics.arcade.accelerateToXY(heart, -200, 400, 100, 100, 100);
                game.physics.arcade.accelerateToXY(scream, -300, 900, 100, 100, 100);
                game.physics.arcade.accelerateToXY(tears, -500, 1000, 100, 100, 100);
                game.physics.arcade.accelerateToXY(tongue, -700, 1300, 100, 100, 100);
                game.physics.arcade.accelerateToXY(upsideDown, -700, 600, 100, 100, 100);
            }
            else {
                game.add.text("Out of Time", 700, 200, "#fff");
            }



        }

        // function gameOver() {
            //timeLabel1.text.opacity = 0;
            // endGame = game.add.text(700, 200, "Game Over", {font: "100px Georgia", fill: "#fff"});
            // endGame.anchor.setTo(0.5);
            //  endGame.align = "center";
            //endButton = Phaser.button(this, 700, 300, "Retry", "Retry", restartGame, this)


        //}

    </script>

</body>
</html>